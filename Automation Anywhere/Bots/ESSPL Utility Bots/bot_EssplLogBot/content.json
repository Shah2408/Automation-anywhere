{"triggers":[],"nodes":[{"uid":"8270704a-ba17-473e-b617-249f080a901a","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"07bc1e77-f932-4008-978c-a0f2822f8689","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Author : Mohammad Shahnawaz"}}]},{"uid":"785a3627-cb79-4c96-8e0a-2d6cdaf9ce7c","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Created on : 29 Dec 2020"}}]},{"uid":"88e77a50-eeb6-4b32-a3ed-80fbd3d89adb","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"This bot is used for Logging into File, into database, send Email message, take Error Screenshot."}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Author, Description and Change History Section"}}]},{"uid":"e13e325b-84e0-403e-a16f-e31ab1092233","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"a627e82c-e46e-4af4-b50c-7b44bcad3cbf","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$i_Config{LogFilePath}$"}},{"name":"logContent","value":{"type":"STRING","expression":"$i_BotName$ : $i_LogType$: $i_ErrorLineNo.Number:toString$ $i_ErrorMessage$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"65c44eec-3e09-4802-b682-f9013aa6ea09","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"63cc9d3f-d731-4095-adbc-e15b6c0c9561","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"connectionMode","value":{"type":"STRING","string":"USER"}},{"name":"databaseProvider","value":{"type":"STRING","string":"SQLOLEDB.1"}},{"name":"server","value":{"type":"STRING","expression":"$i_Config{DBServerName}$"}},{"name":"database","value":{"type":"STRING","expression":"$i_Config{DBName}$"}},{"name":"user","value":{"type":"STRING","expression":"$i_Config{DBUserId}$"}},{"name":"auth","value":{"type":"STRING","expression":"$i_Config{DBPassword}$"}},{"name":"instance","value":{"type":"STRING","string":""}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"dfa8e3ee-4109-4e06-b781-b53d47a7c140","commandName":"store","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","string":"pSaveBotLogDetails"}},{"name":"entryList","value":{"type":"LIST","list":[{"type":"DICTIONARY","dictionary":[{"key":"inOrOutParamter","value":{"type":"STRING","string":"Input"}},{"key":"parametername","value":{"type":"STRING","string":"projectCode"}},{"key":"parametervalue","value":{"type":"STRING","expression":"$i_Config{ProjectCode}$"}},{"key":"outputParamType","value":{"type":"STRING","string":"VARCHAR"}}]},{"type":"DICTIONARY","dictionary":[{"key":"inOrOutParamter","value":{"type":"STRING","string":"Input"}},{"key":"parametername","value":{"type":"STRING","string":"botName"}},{"key":"parametervalue","value":{"type":"STRING","expression":"$i_BotName$"}},{"key":"outputParamType","value":{"type":"STRING","string":"VARCHAR"}}]},{"type":"DICTIONARY","dictionary":[{"key":"inOrOutParamter","value":{"type":"STRING","string":"Input"}},{"key":"parametername","value":{"type":"STRING","string":"logType"}},{"key":"parametervalue","value":{"type":"STRING","expression":"$i_LogType$"}},{"key":"outputParamType","value":{"type":"STRING","string":"VARCHAR"}}]},{"type":"DICTIONARY","dictionary":[{"key":"inOrOutParamter","value":{"type":"STRING","string":"Input"}},{"key":"parametername","value":{"type":"STRING","string":"lineNo"}},{"key":"parametervalue","value":{"type":"STRING","expression":"$i_ErrorLineNo.Number:toString$"}},{"key":"outputParamType","value":{"type":"STRING","string":"INTEGER"}}]},{"type":"DICTIONARY","dictionary":[{"key":"inOrOutParamter","value":{"type":"STRING","string":"Input"}},{"key":"parametername","value":{"type":"STRING","string":"errorMessage"}},{"key":"parametervalue","value":{"type":"STRING","expression":"$i_ErrorMessage$"}},{"key":"outputParamType","value":{"type":"STRING","string":"VARCHAR"}}]}]}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"659e25ce-329c-4c68-9677-7bebb2483978","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"string":"Default","type":"STRING"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$i_Config{IsDBLogOn}$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"True"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"3ca0fa6c-0282-4783-9e8d-3951025f0079","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"04da49da-af41-4496-b079-a14f9b268a94","commandName":"captureWindow","packageName":"Screen","disabled":false,"attributes":[{"name":"windowTitle","value":{"type":"WINDOW","window":{"type":"WINDOW","presetType":"CURRENTLY_ACTIVE"}}},{"name":"filePath","value":{"type":"FILE","expression":"file://$i_Config{ScreenShotFolderPath}$$i_BotName$_$System:Year.Number:toString$-$System:Month.Number:toString$-$System:Day.Number:toString$%20$System:Hour.Number:toString$.$System:Minute.Number:toString$.$System:Second.Number:toString$.png"}},{"name":"isOverwriteFile","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"BOOLEAN","expression":"$i_IsScreenShot$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"booleanVariable","packageName":"Boolean"}}]},{"uid":"a32af440-980d-42e9-9048-b158eff48c89","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"1adf3904-647e-4fa5-8ddc-94fd7d5bced7","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$i_Config{ToEmail}$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"Automation Anywhere finished executing the TaskBot"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"$i_ErrorMessage$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","expression":"$i_Config{FromEmail}$"}},{"name":"emailServerHost","value":{"type":"STRING","string":"smtp.gmail.com"}},{"name":"emailServerPort","value":{"type":"NUMBER","number":"587"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":true}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":true}},{"name":"username","value":{"type":"STRING","expression":"$i_Config{FromEmail}$"}},{"name":"securedPassword","value":{"type":"STRING","expression":"$i_Config{Password}$"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"BOOLEAN","expression":"$i_IsSendEmail$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"booleanVariable","packageName":"Boolean"}}]},{"uid":"2f8defb9-fd19-40bb-b1cb-7a0bf85b38ea","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"o_IsSuccess"}}],"branches":[{"uid":"b25698ca-dfb6-4a2d-91f2-7d20f967334d","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"777851df-d28c-4714-8786-fe2cc6d1b3de","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$i_Config{LogFilePath}$"}},{"name":"logContent","value":{"type":"STRING","expression":"$strBotName$ : EXCEPTION: $o_ErrorLineNo.Number:toString$ $o_ErrorMessage$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"ccecc4da-5887-4e56-ad11-206e3267f3ad","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"o_IsSuccess"}}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"o_ErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"o_ErrorLineNo"}}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"i_config","description":"gets the configuration data for DB, Email and File path for logging and screenshot","type":"DICTIONARY","readOnly":false,"input":true,"output":false,"subtype":"ANY","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"o_IsSuccess","description":"Returns the status of the Bot, True for Success or False for Failed","type":"BOOLEAN","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"o_ErrorLineNo","description":"","type":"NUMBER","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"i_ErrorLineNo","description":"gets the error line number to log","type":"NUMBER","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"i_LogType","description":"gets the log type: DEBUG, EXCEPTION, WARNING","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"i_IsSendEmail","description":"gets the boolean value True to send email","type":"BOOLEAN","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"i_IsScreenShot","description":"gets the boolean value True to take screenshot of the current screen","type":"BOOLEAN","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"i_BotName","description":"get the bot name where exception has occurred.","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"i_ErrorMessage","description":"get the error message for logging","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"o_ErrorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"strBotName","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"EssplLogBot"}}],"breakpoints":["dfa8e3ee-4109-4e06-b781-b53d47a7c140"],"packages":[{"name":"Boolean","version":"2.1.0-20200831-031000"},{"name":"Comment","version":"2.1.0-20200831-031015"},{"name":"Database","version":"2.1.0-20200913-060112"},{"name":"Email","version":"3.0.0-20200901-105426"},{"name":"ErrorHandler","version":"2.1.0-20200831-031055"},{"name":"If","version":"2.1.0-20200825-071156"},{"name":"LogToFile","version":"2.2.0-20200831-031539"},{"name":"Number","version":"2.1.0-20200831-031551"},{"name":"Screen","version":"2.1.0-20200825-071618"},{"name":"Step","version":"2.0.0-20200907-072944"},{"name":"String","version":"3.1.0-20200831-031943"},{"name":"System","version":"3.0.0-20200831-031944"}],"migrationJournalReviewIds":[],"workItemTemplateName":null}